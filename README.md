В этом репозитории два скрипта: один обрабатывает запись студентов на проект, другой генерирует оценочные листы в формате pdf по таблице.

[Сайт НИС 2021](https://sites.google.com/view/nis2021)

# Запись студентов на проект
В таблице "НИС 1 курс 2021" хранится список проектов для студентов первого курса. Студенты заполняют google-форму и выбирают три задачи с разными приоритетами. Скрипт `process project requests.ipynb` обрабатывает таблицу с ответами на форму и записывает имя студента напротив задачи. Если задача первого приоритета занята, то проверяется задача второго приоритета. Если задачи нет в таблице, то просто добавляет новую задачу и  записывает на нее студента. Log обработки ответов на форму пишется в таблицу, доступную на чтение для студента

## Требования
Для чтения данных из таблицы и записи используются следующие модули: 
```
import gspread
from oauth2client.service_account import ServiceAccountCredentials
```

Необходим сервисный аккаунт, которому надо будет дать права на редактирование таблицы
[https://www.twilio.com/blog/2017/02/an-easy-way-to-read-and-write-to-a-google-spreadsheet-in-python.html]
В этом примере сервисный аккаунт называется `nis2021@nis2021-2.iam.gserviceaccount.com`, а credentials хранятся в `NIS2021-2-6b794392fe59.json`.


## Сделано
- Чтение и запись в разные таблицы. Так как есть ограничение на количество записей в минуту, сделана задержка по времени
- Обработка приоритетов
- Уже записавшийся студент больше не добавляется в таблицу
- Обработка групповых проектов
- Добавление новой задачи

## TODO
- Исправление опечаток в названии задачи, на которую записывается студент
- Удаление лишних пробелов из имени студента или названия задачи
- Автомаический запуск скрипта
- Возможен баг с датами. Обработка работала корректно для записей в течение одного и того же месяца

# Генерация оценочных листов для Профориентационного семинара
Оценки студенческих проектов собираются через google форму. Преподаватель указывает свое имя, название проекта, имя студента и две оценки, из которых рассчитывается итоговая оценка за проект. Ответы на google форму хранятся в google таблице (spreadsheet). Скрипт `gen pdf.ipynb` получает данные об оценках из google таблицы, дополняет имя студента до ФИО, находит группу студента по его имени и фамилии. Затем для записей, по которым еще не сгенерированы оценочные листы, подставляет данные в `mark_template_py.tex`  и запускает `pdflatex.exe` для генерации pdf файла. 

## Требования
Для получения данных из онлайн-таблицы используются следующие модули: 
```
import gspread
from oauth2client.service_account import ServiceAccountCredentials
```

Необходим сервисный аккаунт, которому надо будет дать права на редактирование таблицы
[https://www.twilio.com/blog/2017/02/an-easy-way-to-read-and-write-to-a-google-spreadsheet-in-python.html]
В этом примере сервисный аккаунт называется `nis2021@nis2021-2.iam.gserviceaccount.com`, а credentials хранятся в `NIS2021-2-6b794392fe59.json`.

Установленный LaTeX. С помощью модуля `subprocess` запускается программа для генерации pdf в командной строке. Команду я подсмотрела в texStudio при запуске компиляции, `pdflatex.exe -synctex=1 -interaction=nonstopmode filename.tex` 

## Что сделано
- Поиск ФИО студента по ФИ, ФИ могут идти в любом порядке
- Определение группы студента. Для этого должен быть полный список студентов по группам
- Подстановка данных в tex-шаблон и запуск pdflatex для генерации pdf

## TODO
- Исправление опечаток в имени студента
- Если ФИО студента состоит из более чем трех слов, то возникает ошибка
- Иногда pdflatex не генерирует pdf, тогда приходится текст tex-файла вставлять в шаблон на overleaf и там все компилировать
- После генерации файла необходимо обновить статус записи в google таблице, сейчас это делается руками
- Перенос записей из таблицы с результатами формы в таблицу с общими результатами по НИСу